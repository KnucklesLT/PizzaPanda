<%- include('../partials/html-head') %>
<%- include('../partials/nav') %>

<main>
  <h1>hello, <%= user ? user.profile.name : "friend" %></h1>
  <% if (user?.profile.avatar) { %>
    <div>
      <img
        src="<%= user.profile.avatar %>"
        alt="<%= user.profile.name %> avatar"
      />
    </div>
  <% } %>

  <h1>All Meals</h1>
  <h2>Added by our wonderful members!</h2>
  <% meals.forEach(meal => { %>
    <div class="card" style="width: 18rem;">
      <div class="card-body">
        <h5 class="card-title"><%= meal.name %> </h5>
        <h6 class="card-subtitle mb-2 text-muted"><%= meal.mealType %> </h6>
        <p class="card-text"><%= meal.description %></p>
        <% if (meal.creator.equals(user?.profile._id)) { %>
          <a href="/meals/<%= meal._id %>/edit" class="card-link">
            <button class="btn">Edit this Meal</button>
          </a>
          <form action="/meals/<%= meal._id %>?_method=DELETE" method="post">
            <button type="submit" class="btn">Delete Meal</button>
          </form>
        <% } %>
      </div>
    </div>
  <% }) %>

</main>

<%- include('../partials/footer') %>
